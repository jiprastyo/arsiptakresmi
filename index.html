<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arsip Tidak Resmi</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f8f8;
            --bg-hover: #f0f0f0;
            --bg-header: #ffffff;
            --text-primary: #333333;
            --text-secondary: #666666;
            --text-label: #888888;
            --border-color: #e0e0e0;
            --button-bg: #ffffff;
            --button-border: #cccccc;
            --button-hover-bg: #f5f5f5;
            --active-bg: #333333;
            --active-text: #ffffff;
            --link-color: #2196f3;
            --sort-icon-color: #999;
        }
        
        /* AMOLED DARK MODE PALETTE */
        [data-theme="dark"] {
            --bg-primary: #000000;
            --bg-secondary: #121212;
            --bg-hover: #1a1a1a;
            --bg-header: #000000;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-label: #666666;
            --border-color: #333333;
            --button-bg: #121212;
            --button-border: #444444;
            --button-hover-bg: #222222;
            --active-bg: #ffffff;
            --active-text: #000000;
            --link-color: #64b5f6;
            --sort-icon-color: #666;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', 'Arial', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 13px;
            transition: background 0.3s, color 0.3s;
        }
        
        .container { max-width: 100%; margin: 0 auto; }
        
        /* HEADER */
        .header {
            background: var(--bg-primary);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .header h1 { font-size: 18px; font-weight: 700; margin: 0; }
        
        .toggle-btn {
            padding: 6px 12px;
            border: 1px solid var(--button-border);
            background: var(--button-bg);
            color: var(--text-primary);
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s;
        }
        .toggle-btn:hover { background: var(--button-hover-bg); }

        /* CONTROLS SECTION */
        .controls {
            padding: 15px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Search Bar */
        .search-container { width: 100%; }
        .search-box {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--button-border);
            background: var(--bg-primary);
            color: var(--text-primary);
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s;
        }
        .search-box:focus { outline: none; border-color: var(--text-secondary); }

        /* Filter Areas */
        .filters-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: flex-end;
        }

        .filter-section {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .section-label {
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-label);
        }

        /* Category Buttons (Scrollable on Mobile) */
        .category-group {
            display: flex;
            gap: 6px;
            overflow-x: auto;
            padding-bottom: 2px; /* Space for scrollbar */
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Hide scrollbar Firefox */
        }
        .category-group::-webkit-scrollbar { display: none; } /* Hide scrollbar Chrome */

        .filter-btn {
            padding: 6px 14px;
            border: 1px solid var(--button-border);
            background: var(--button-bg);
            color: var(--text-primary);
            border-radius: 20px; /* Pill shape */
            cursor: pointer;
            font-size: 12px;
            white-space: nowrap;
            transition: all 0.2s;
        }
        .filter-btn:hover { border-color: var(--text-secondary); background: var(--button-hover-bg); }
        .filter-btn.active {
            background: var(--active-bg);
            color: var(--active-text);
            border-color: var(--active-bg);
        }

        /* Period Dropdowns */
        .period-group {
            display: flex;
            gap: 8px;
        }

        select {
            padding: 6px 30px 6px 12px;
            border: 1px solid var(--button-border);
            background-color: var(--button-bg);
            color: var(--text-primary);
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            appearance: none; /* Remove default arrow */
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23999999%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 8px top 50%;
            background-size: 8px auto;
            min-width: 100px;
        }
        
        [data-theme="dark"] select {
             background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23ffffff%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
        }

        select:focus { border-color: var(--text-secondary); outline: none; }

        .reset-btn {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 11px;
            cursor: pointer;
            text-decoration: underline;
            padding: 0 5px;
        }
        .reset-btn:hover { color: var(--text-primary); }

        /* TABLE */
        .stats {
            padding: 10px 20px;
            font-size: 11px;
            color: var(--text-secondary);
            display: flex;
            gap: 15px;
        }

        .table-container { overflow-x: auto; }
        
        table { width: 100%; border-collapse: collapse; }
        
        thead {
            background: var(--bg-header);
            border-top: 1px solid var(--border-color);
            border-bottom: 2px solid var(--border-color);
        }
        
        th {
            padding: 10px 12px;
            text-align: left;
            font-weight: 700;
            font-size: 11px;
            text-transform: uppercase;
            color: var(--text-secondary);
            cursor: pointer;
            user-select: none;
            white-space: nowrap;
        }
        th:hover { color: var(--text-primary); }
        
        /* Sort Icons */
        th::after {
            content: '‚Üï';
            font-size: 10px;
            margin-left: 4px;
            opacity: 0.2;
        }
        th.sort-asc::after { content: '‚ñ≤'; opacity: 1; color: var(--active-bg); }
        th.sort-desc::after { content: '‚ñº'; opacity: 1; color: var(--active-bg); }
        th.no-sort { cursor: default; }
        th.no-sort::after { content: ''; }

        td {
            padding: 8px 12px;
            font-size: 13px;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
        }
        
        tbody tr:hover { background: var(--bg-hover); }

        /* BADGES */
        .category-cell {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .category-kuesioner { background: #e3f2fd; color: #1565c0; }
        .category-klasifikasi { background: #f3e5f5; color: #6a1b9a; }
        .category-pedoman { background: #fff3e0; color: #ef6c00; }
        .category-publikasi { background: #e8f5e9; color: #2e7d32; }
        .category-sejarah { background: #fce4ec; color: #c2185b; }
        
        [data-theme="dark"] .category-kuesioner { background: #0d47a1; color: #bbdefb; }
        [data-theme="dark"] .category-klasifikasi { background: #4a148c; color: #e1bee7; }
        [data-theme="dark"] .category-pedoman { background: #e65100; color: #ffe0b2; }
        [data-theme="dark"] .category-publikasi { background: #1b5e20; color: #c8e6c9; }
        [data-theme="dark"] .category-sejarah { background: #880e4f; color: #f8bbd0; }

        .link-btn {
            display: inline-block;
            padding: 4px 10px;
            background: var(--link-color);
            color: #fff;
            border-radius: 4px;
            text-decoration: none;
            font-size: 11px;
            font-weight: 600;
            transition: opacity 0.2s;
        }
        [data-theme="dark"] .link-btn { color: #000; }
        .link-btn:hover { opacity: 0.8; }

        .lang-badge {
            font-size: 10px;
            font-weight: 700;
            padding: 1px 4px;
            border-radius: 3px;
            margin-left: 6px;
            border: 1px solid currentColor;
            opacity: 0.7;
        }
        .lang-id { color: #d32f2f; background: #ffebee; border-color: #ffcdd2; }
        .lang-en { color: #00796b; background: #e0f2f1; border-color: #b2dfdb; }
        [data-theme="dark"] .lang-id { color: #ffcdd2; background: #b71c1c; border-color: #e57373; }
        [data-theme="dark"] .lang-en { color: #b2dfdb; background: #004d40; border-color: #4db6ac; }

        .note-cell { font-size: 12px; color: var(--text-secondary); font-style: italic; }
        .no-results { text-align: center; padding: 40px; color: var(--text-secondary); }

        @media (max-width: 768px) {
            .filters-wrapper { flex-direction: column; align-items: flex-start; gap: 15px; }
            .category-group { width: 100%; }
            .period-group { width: 100%; flex-wrap: wrap; }
            select { flex: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="pageTitle">üìä Arsip Tidak Resmi</h1>
            <div class="header-controls">
                <button class="toggle-btn" id="langToggle">üåê EN</button>
                <button class="toggle-btn" id="themeToggle">üåô Dark</button>
            </div>
        </div>
        
        <div class="controls">
            <div class="search-container">
                <input type="text" id="searchInput" class="search-box" placeholder="üîç Cari dokumen, tahun, atau kategori...">
            </div>
            
            <div class="filters-wrapper">
                <div class="filter-section">
                    <span class="section-label" id="labelCategory">Kategori</span>
                    <div class="category-group">
                        <button class="filter-btn active" data-filter="all" data-lang-id="Semua" data-lang-en="All">Semua</button>
                        <button class="filter-btn" data-filter="kuesioner" data-lang-id="Kuesioner" data-lang-en="Questionnaire">Kuesioner</button>
                        <button class="filter-btn" data-filter="klasifikasi" data-lang-id="Klasifikasi" data-lang-en="Classification">Klasifikasi</button>
                        <button class="filter-btn" data-filter="pedoman" data-lang-id="Pedoman" data-lang-en="Guidelines">Pedoman</button>
                        <button class="filter-btn" data-filter="publikasi" data-lang-id="Publikasi" data-lang-en="Publications">Publikasi</button>
                        <button class="filter-btn" data-filter="sejarah" data-lang-id="Sejarah" data-lang-en="History">Sejarah</button>
                    </div>
                </div>

                <div class="filter-section">
                    <span class="section-label" id="labelPeriod">Periode</span>
                    <div class="period-group">
                        <select id="yearFilter">
                            <option value="all" data-lang-id="Semua Tahun" data-lang-en="All Years">Semua Tahun</option>
                        </select>
                        <select id="monthFilter">
                            <option value="all" data-lang-id="Semua Bulan" data-lang-en="All Months">Semua Bulan</option>
                            <option value="januari">Januari / January</option>
                            <option value="februari">Februari / February</option>
                            <option value="maret">Maret / March</option>
                            <option value="april">April</option>
                            <option value="mei">Mei / May</option>
                            <option value="juni">Juni / June</option>
                            <option value="juli">Juli / July</option>
                            <option value="agustus">Agustus / August</option>
                            <option value="september">September</option>
                            <option value="oktober">Oktober / October</option>
                            <option value="november">November</option>
                            <option value="desember">Desember / December</option>
                        </select>
                        <button id="resetFilters" class="reset-btn">Reset</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="stats">
            <div><span id="totalLabel">Total</span>: <span id="totalCount">0</span></div>
            <div><span id="showingLabel">Tampil</span>: <span id="visibleCount">0</span></div>
        </div>
        
        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th style="width: 1%;" class="no-sort">No</th>
                        <th style="width: 1%;" id="thYear" data-sort="year">Tahun</th>
                        <th style="width: 1%;" id="thPeriod" data-sort="period">Periode</th>
                        <th style="width: 1%;" id="thCategory" data-sort="category">Kategori</th>
                        <th style="width: 1%;" class="no-sort" id="thLink">Link</th>
                        <th style="width: auto;" id="thTitle" data-sort="title">Judul</th>
                        <th style="width: 20%;" id="thNote" data-sort="note">Catatan</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
            <div id="noResults" class="no-results" style="display: none;">
                <span id="noResultsText">Tidak ada hasil yang ditemukan</span>
            </div>
        </div>
    </div>

    <script>
        // --- CONFIGURATION & STATE ---
        let currentLang = 'id';
        let currentTheme = 'light';
        let sortConfig = {
            key: 'year', // Default sort by Year
            direction: 'desc', // Default Descending (Newest first)
            secondaryKey: 'period',
            secondaryDirection: 'desc' // December to January
        };

        const monthWeight = {
            'januari': 1, 'january': 1,
            'februari': 2, 'february': 2,
            'maret': 3, 'march': 3,
            'april': 4,
            'mei': 5, 'may': 5,
            'juni': 6, 'june': 6,
            'juli': 7, 'july': 7,
            'agustus': 8, 'august': 8,
            'september': 9,
            'oktober': 10, 'october': 10,
            'november': 11,
            'desember': 12, 'december': 12,
            '-': 0
        };

        // --- TRANSLATIONS ---
        const translations = {
            id: {
                pageTitle: 'üìä Arsip Tidak Resmi',
                searchPlaceholder: 'üîç Cari dokumen, tahun, atau kategori...',
                year: 'Tahun',
                month: 'Bulan',
                period: 'Periode',
                category: 'Kategori',
                title: 'Judul',
                link: 'Link',
                note: 'Catatan',
                total: 'Total',
                showing: 'Tampil',
                noResults: 'Tidak ada hasil yang ditemukan',
                openFile: 'Buka',
                labelCategory: 'KATEGORI',
                labelPeriod: 'PERIODE',
                allYears: 'Semua Tahun',
                allMonths: 'Semua Bulan'
            },
            en: {
                pageTitle: 'üìä Unofficial Archive',
                searchPlaceholder: 'üîç Search documents, years, or categories...',
                year: 'Year',
                month: 'Month',
                period: 'Period',
                category: 'Category',
                title: 'Title',
                link: 'Link',
                note: 'Note',
                total: 'Total',
                showing: 'Showing',
                noResults: 'No results found',
                openFile: 'Open',
                labelCategory: 'CATEGORY',
                labelPeriod: 'PERIOD',
                allYears: 'All Years',
                allMonths: 'All Months'
            }
        };

        // --- DATABASE TERBARU (Updated from Spreadsheet) ---
        const data = [
            { year: 2004, period: "-", category: "Kuesioner", link: "https://drive.google.com/file/d/1LXIKCtMYlDTG3tc7tqGKmPgVyIWyErc8/preview", title: "2004 ENV1", lang: "ID", note: "" },
            { year: 2004, period: "-", category: "Kuesioner", link: "https://drive.google.com/file/d/1qjTIqehm5hFNtmWa0P2ayywB4EJazbOn/preview", title: "2004 ENV2", lang: "ID", note: "" },
            { year: 2008, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2009/11/23/069fde9ab6e06cd674e0a608/analisis-mobilitas-tenaga-kerja-hasil-survei-angkatan-kerja-nasional-2008.html", title: "Analisis Mobilitas Tenaga Kerja", lang: "ID", note: "pertama kali terbit" },
            { year: 2010, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2011/12/09/27c1eafe9ae25b8775753a78/analisis-mobilitas-tenaga-kerja-hasil-survei-angkatan-kerja-nasional-2010.html", title: "Analisis Mobilitas Tenaga Kerja", lang: "ID", note: "" },
            { year: 2012, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2013/11/04/60be1c892ff94a29ebfcc24b/analisis-mobilitas-tenaga-kerja-hasil-survei-angkatan-kerja-nasional-2012.html", title: "Analisis Mobilitas Tenaga Kerja", lang: "ID", note: "" },
            { year: 2016, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2017/12/08/a85da15eb324f53f05163351/analisis-mobilitas-tenaga-kerja-hasil-survei-angkatan-kerja-nasional-2016.html", title: "Analisis Mobilitas Tenaga Kerja", lang: "ID", note: "" },
            { year: 2018, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2019/12/09/4abf897285f4e8265346d8d7/analisis-mobilitas-tenaga-kerja-hasil-survei-angkatan-kerja-nasional-2018.html", title: "Analisis Mobilitas Tenaga Kerja", lang: "ID", note: "" },
            { year: 2020, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2021/11/17/bf53c37506d4a38a2a700f5a/analisis-mobilitas-tenaga-kerja-hasil-survei-angkatan-kerja-nasional-2020.html", title: "Analisis Mobilitas Tenaga Kerja", lang: "ID", note: "" },
            { year: 2022, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2023/10/27/83d4aaefa732e79efa75107b/analisis-mobilitas-tenaga-kerja-hasil-sakernas-2022.html", title: "Analisis Mobilitas Tenaga Kerja", lang: "ID", note: "" },
            { year: 2023, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2024/08/26/b07cde6196c248635467c2af/analisis-mobilitas-tenaga-kerja-hasil-sakernas-2023.html", title: "Analisis Mobilitas Tenaga Kerja", lang: "ID", note: "" },
            { year: 2024, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2025/08/22/8934c883888698d7acb2e179/analisis-mobilitas-tenaga-kerja-hasil-sakernas-2024.html", title: "Analisis Mobilitas Tenaga Kerja", lang: "ID", note: "" },
            { year: 1982, period: "-", category: "Kuesioner", link: "https://drive.google.com/file/d/1CNnl9Kt42JEqDHz-BrD-1SgFqqo8kKOw/preview", title: "Bagian dari Susenas", lang: "ID", note: "" },
            { year: 2018, period: "Februari", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2018/09/28/c49b09bd9fcb72050c51958e/booklet-survei-angkatan-kerja-nasional-februari-2018.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2018, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2018/12/14/646b4fb626979f3e154e63d7/booklet-survei-angkatan-kerja-nasional-agustus-2018.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2019, period: "Februari", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2019/11/27/5428e1117e138c6d36769363/booklet-survei-angkatan-kerja-nasional-februari-2019.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2019, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2019/12/10/680c34c3a8c4955c235892c9/booklet-survei-angkatan-kerja-nasional-agustus-2019.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2020, period: "Februari", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2020/08/28/2aaf3f1339f9295704cb198f/booklet-survei-angkatan-kerja-nasional-februari-2020.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2020, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2020/12/23/d8b9a75ce826ddafbddb9657/booklet-survei-angkatan-kerja-nasional-agustus-2020.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2021, period: "Februari", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2021/08/09/790fa89d429d86821c12f57b/booklet-survei-angkatan-kerja-nasional-februari-2021.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2021, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2021/12/22/52d405e2dc5dc6f2ba57bf83/booklet-survei-angkatan-kerja-nasional-agustus-2021.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2022, period: "Februari", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2023/07/07/40a0b3f1fd46be1a5edbae1d/booklet-survei-angkatan-kerja-nasional-februari-2023.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2022, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2023/12/22/ffb3e2d42b94d727d97e78d8/booklet-survei-angkatan-kerja-nasional-agustus-2023.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2023, period: "Februari", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2023/07/07/40a0b3f1fd46be1a5edbae1d/booklet-survei-angkatan-kerja-nasional-februari-2023.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2023, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2023/12/22/ffb3e2d42b94d727d97e78d8/booklet-survei-angkatan-kerja-nasional-agustus-2023.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2024, period: "Februari", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2024/07/05/0455778ea851bbeda66890a8/booklet-sakernas-februari-2024.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2024, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2024/12/20/145b7ca9b2e159c6c0493290/booklet-sakernas-agustus-2024.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2025, period: "Februari", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2025/07/14/90a6b20c25c63176d23ab46c/booklet-sakernas-februari-2025.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2025, period: "Agustus", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2026/01/12/7cafd1df082c81784e0e15f8/booklet-sakernas-agustus-2025.html", title: "Booklet", lang: "ID", note: "" },
            { year: 2021, period: "Desember", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2021/12/22/42c332115ba2a6fb0f36590c/booklet-keselamatan-dan-kesehatan-pekerja-di-masa-pandemi-covid-19.html", title: "Booklet COVID-19", lang: "ID", note: "Booklet Keselamatan dan Kesehatan Pekerja di Masa Pandemi COVID-19" },
            { year: 2023, period: "Januari", category: "Publikasi", link: "https://www.bps.go.id/id/publication/2023/01/24/26f9953aa34944a5ad539815/booklet-pekerja-anak-di-indonesia-2022-sebelum-dan-semasa-pandemi-covid-19-.html", title: "Booklet Pekerja Anak ", lang: "ID", note: "Booklet Pekerja Anak di Indonesia 2022 Sebelum dan Semasa Pandemi COVID-19." },
            { year: 2002, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/1z9SNTH6qdMqdFmxaGrH4T9BDBXql-VoE/preview", title: "Kode KBJI 2002", lang: "ID", note: "" },
            { year: 2000, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/1hr_wueqTWoN-3n2b5kyu9RAPSDHyXIDh/preview", title: "Kode KBLI 2000", lang: "ID", note: "" },
            { year: 2005, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/1nfgELonhGXOygDPWe_EJ7ULuxoK3yD4B/preview", title: "Kode KBLI 2005", lang: "ID", note: "" },
            { year: 2009, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/1zXYx9jqOweicyDWi3fC0YTJ75vNkjZM0/preview", title: "Kode KBLI 2009", lang: "ID", note: "" },
            { year: 1982, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/1hr_wueqTWoN-3n2b5kyu9RAPSDHyXIDh/preview", title: "Kode KJI 1982", lang: "ID", note: "" },
            { year: 1986, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/147QvWKzSV-LlUD-aCWa9TYqAfm6boYzrCoJ8y0y4xZY/preview", title: "Kode Sektor 1986-1994", lang: "ID", note: "berlaku di 1986-1994" },
            { year: 1987, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/147QvWKzSV-LlUD-aCWa9TYqAfm6boYzrCoJ8y0y4xZY/preview", title: "Kode Sektor 1986-1994", lang: "ID", note: "berlaku di 1986-1994" },
            { year: 1988, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/147QvWKzSV-LlUD-aCWa9TYqAfm6boYzrCoJ8y0y4xZY/preview", title: "Kode Sektor 1986-1994", lang: "ID", note: "berlaku di 1986-1994" },
            { year: 1989, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/147QvWKzSV-LlUD-aCWa9TYqAfm6boYzrCoJ8y0y4xZY/preview", title: "Kode Sektor 1986-1994", lang: "ID", note: "berlaku di 1986-1994" },
            { year: 1990, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/147QvWKzSV-LlUD-aCWa9TYqAfm6boYzrCoJ8y0y4xZY/preview", title: "Kode Sektor 1986-1994", lang: "ID", note: "berlaku di 1986-1994" },
            { year: 1991, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/147QvWKzSV-LlUD-aCWa9TYqAfm6boYzrCoJ8y0y4xZY/preview", title: "Kode Sektor 1986-1994", lang: "ID", note: "berlaku di 1986-1994" },
            { year: 1992, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/147QvWKzSV-LlUD-aCWa9TYqAfm6boYzrCoJ8y0y4xZY/preview", title: "Kode Sektor 1986-1994", lang: "ID", note: "berlaku di 1986-1994" },
            { year: 1993, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/147QvWKzSV-LlUD-aCWa9TYqAfm6boYzrCoJ8y0y4xZY/preview", title: "Kode Sektor 1986-1994", lang: "ID", note: "berlaku di 1986-1994" },
            { year: 1994, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/147QvWKzSV-LlUD-aCWa9TYqAfm6boYzrCoJ8y0y4xZY/preview", title: "Kode Sektor 1986-1994", lang: "ID", note: "berlaku di 1986-1994" },
            { year: 1996, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/1ev5rW7nMKO1Thj7xqHLX8NRyQcZYXx1i/preview", title: "Kode Sektor 1996-1999", lang: "ID", note: "" },
            { year: 1997, period: "-", category: "Klasifikasi", link: "https://drive.google.com/file/d/1O-ENWaqqijPBI4aVnn5_Id521N9G6cw4/preview", title: "Kode Sektor 1997", lang: "ID", note: "" },
            { year: 2022, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1ZZa8286OMRAgnKr85mHwjSKtqMWBUtUC/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2022, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1BuHprM2NxEYFnhdhuD8eWHJ7UMP6J820/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2023, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1Zkqhm9rm1Xyn4PuknYnhWBLHt_8N4OeO/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2023, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1eEeglx_SBJxg3_zs7nyJo9iGrjNcWjoU/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2024, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1fVI32P5as6jmszrkKEjHmadu9LGXG1NU/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2024, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1n7XXbGnTDGCmah0NM0k7ILIzEy1joXM9/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2025, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1SxeXN8bG-9EBwW-CklnoEcUyZPHfbUZB/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2025, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/144Jn0sTv4OKUv2j9Oh51fY1W4s_bOMUN/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2025, period: "November", category: "Kuesioner", link: "https://drive.google.com/file/d/1NE0BzLG9mF_xHzhplyfYeWvuzlFNN-SR/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2021, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1ajPf3dy3EOgmpoRxdjy0iLsGFEzg96N7/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2021, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1v3CcJDlwePL-b5WuZur4q3hkuUALxZlb/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2020, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1uopRLxDlg161u4cvaiX8SmDryY8J-ELv/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2020, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/12YtOpVRgoAw7Ca99IXL0dhcB_NDeZH5r/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2019, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1plo1IRT6WeG3Hs8l-aBjasvFdlSQj4_4/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2019, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1z01GGgbYZxodheoWxb_LSyRXuzuNC-fk/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2018, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/11jo21tnO3dto2jxKCezsWCgJKtFsWJyB/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2018, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1ePwRxz19DOlwuXJwncJOcDv5Xc-PwvSl/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2017, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1yez4L864XGNvfDueFqnRTDT7GIv1Hv9K/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2017, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/17Flq9cunsaIvRqvVG4m7kR9e3LadVD42/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2016, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1VO1ez6shkuPUwtm907Yp4gSANes-vcFC/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2016, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1uR0cw3imxmbs-PF9UH1sZz0lNXQiN6YU/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2015, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1swM3rAmfD3XLOvSyR-I4gZP2yhRgPA6K/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2015, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1hktoyHoeTQwnK6OmpePnieelQ7emWu40/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2014, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/10PP5preJgx0yZwVxxanLpa9lbO408G5y/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2014, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1oVQQDrRSYtt6vFBZF0vDULAAQpBI5Pbi/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2014, period: "Mei", category: "Kuesioner", link: "https://drive.google.com/file/d/1N65Qrdv5ewob1SDlo--zI-jJ8WMTMiuD/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2013, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/109r_2wmO6SVWFyK7Dzm2RihmqJ-o0HdN/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2013, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1OfIpaunafoSZ7DjKuotzLr0aDq3T0F7F/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2013, period: "Mei", category: "Kuesioner", link: "https://drive.google.com/file/d/1TVa7Hy_9soVaON57m_iSzBRf7IvsBF9I/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2013, period: "November", category: "Kuesioner", link: "https://drive.google.com/file/d/1xWJsC3ZSI2zUHPT6RVxqD-vGmGjBTTWS/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2012, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1rdDDNGkQF04DCGVpmgjL5EiUcGJAlNTz/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2011, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1m6BD1oL8IQTY4URW8UDNoQe4lZqentfQ/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2010, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1B5HyiQJNCmJpRVl7OxLfIgknUy9bpuRg/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2009, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/164RCkEaxHKSFaLUHfPiNThfLgd_qft_b/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2008, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1rOR5Iz1DGNSxBsXjJur1Vk_fqF0dO0T9/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2007, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1XcAvg4RtjRNxZWxW9VMy6vqjIBNlhqjr/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2006, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1hRC9gna3RHbHBhbC0-6VDbb2ULmeitNX/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2006, period: "November", category: "Kuesioner", link: "https://drive.google.com/file/d/1lQXq9n9s4KuC12ozFIxlwPNLJ9g0uv2I/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2005, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1tQ3Kwsfz-MkmqnrrWS0vFmurwrgRGLA3/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2005, period: "Februari", category: "Kuesioner", link: "https://drive.google.com/file/d/1UcLbc8khF9rTzsnMmz2eEj9ux0Hp8Az-/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2004, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1bemkW8Ce5mIfxpCZtymvUXcTMQiW-VjF/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2003, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1WBJmzpneIwA0tv_A5zVKfVI7S2KonIJ4/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2002, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1WcESB4bGA4hyElmzCx6oHuT_AMBNY-qu/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2001, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1R97gpVGxqaAWaqqZMUrQoKrYJvVJaW1m/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 2000, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/19hN-0y6YUcZPM-UPa37ySgYsvW2mXYeU/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1999, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1WPLYk8U85zQJVhWMAz7OWDZLQXwC5S5w/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1998, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1DDtADqhAY8Jcb2PWWY8lKUW14KqSxfiw/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1997, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/19RFSQglY5QQ1OZVRubyWwV3UF4L8jmcq/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1996, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1NLN6CXuxxrFib1GZc7revEg17TOTsYEk/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1993, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/10p9l6O1dyXUORjLvijSvmmLnRPfgc9SU/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1990, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1Ne7MluH3d_clSGKf0ctHKmGI6U1vFbYH/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1989, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/153Nvz10ieMa1a0zrPddmPIFhAwYLtO1C/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1987, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1iJ-yQXoX2QJ_KySzeyepU8d5vwYW6kOr/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1986, period: "Agustus", category: "Kuesioner", link: "https://drive.google.com/file/d/1BUM5J9BgdSSMHKKBsOX038qoPayqQiCy/preview", title: "Kuesioner", lang: "ID", note: "" },
            { year: 1987, period: "-", category: "Sejarah", link: "https://drive.google.com/file/d/1zkGqLaJDk3Z1NmV9JMQEUcQ8h7RZDRAz/preview", title: "Sakernas Volume 1", lang: "ID", note: "Developmet Studies Volume I Labor Force and Wages Bappenas BPS" },
            { year: 1988, period: "-", category: "Sejarah", link: "https://drive.google.com/file/d/1jTZK25BGtjVtRQwffXiFPHy79t7wiKqN/preview", title: "Sakernas Volume 2", lang: "ID", note: "Developmet Studies Volume II Wage Data Bappenas BPS" },
            { year: "-", period: "-", category: "Sejarah", link: "https://dsbb.imf.org/sdds/summary-methodology-base/country/IDN/category/EMP00", title: "Sejarah", lang: "EN", note: "metadata IMF" },
            { year: "-", period: "-", category: "Sejarah", link: "https://www.rand.org/health/surveys/bps/sakernas.html", title: "Sejarah", lang: "EN", note: "metadata RAND" }
        ];
        
        let filteredData = [...data];
        let currentFilter = 'all';
        let currentYearFilter = 'all';
        let currentMonthFilter = 'all';
        
        // --- HELPER FUNCTIONS ---
        function normalizeMonth(month) {
            if (!month) return '-';
            const m = month.toString().toLowerCase();
            const map = {
                'januari': 'januari', 'january': 'januari',
                'februari': 'februari', 'february': 'februari',
                'maret': 'maret', 'march': 'maret',
                'april': 'april',
                'mei': 'mei', 'may': 'mei',
                'juni': 'juni', 'june': 'juni',
                'juli': 'juli', 'july': 'juli',
                'agustus': 'agustus', 'august': 'agustus',
                'september': 'september',
                'oktober': 'oktober', 'october': 'oktober',
                'november': 'november',
                'desember': 'desember', 'december': 'desember'
            };
            return map[m] || m;
        }
        
        function populateYearFilter() {
            const years = [...new Set(data.map(item => item.year))].sort((a, b) => {
                // Filter out non-numeric years for sorting, treat "-" as 0 or simply put at end
                const numA = (a === "-") ? -9999 : a;
                const numB = (b === "-") ? -9999 : b;
                if (numA === -9999) return 1; // Put "-" at end
                if (numB === -9999) return -1;
                return numB - numA; // Descending
            });
            
            const yearSelect = document.getElementById('yearFilter');
            years.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            });
        }
        
        // --- CORE LOGIC (SORT & RENDER) ---
        function sortData(key) {
            // Update direction
            if (sortConfig.key === key) {
                sortConfig.direction = sortConfig.direction === 'asc' ? 'desc' : 'asc';
            } else {
                sortConfig.key = key;
                sortConfig.direction = 'asc'; // Default for text columns
                if (key === 'year' || key === 'period') sortConfig.direction = 'desc'; // Default desc for time
            }

            // Update UI Icons
            document.querySelectorAll('th[data-sort]').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
                if (th.dataset.sort === key) {
                    th.classList.add(sortConfig.direction === 'asc' ? 'sort-asc' : 'sort-desc');
                }
            });

            // Sorting Algorithm
            filteredData.sort((a, b) => {
                let valA, valB;

                if (sortConfig.key === 'year') {
                    valA = a.year === '-' ? -9999 : a.year;
                    valB = b.year === '-' ? -9999 : b.year;
                } else if (sortConfig.key === 'period') {
                    valA = monthWeight[normalizeMonth(a.period)] || 0;
                    valB = monthWeight[normalizeMonth(b.period)] || 0;
                } else {
                    valA = (a[sortConfig.key] || '').toString().toLowerCase();
                    valB = (b[sortConfig.key] || '').toString().toLowerCase();
                }

                // Primary Sort
                if (valA < valB) return sortConfig.direction === 'asc' ? -1 : 1;
                if (valA > valB) return sortConfig.direction === 'asc' ? 1 : -1;

                // Secondary Sort (Stability): Always Year Desc -> Month Desc
                if (sortConfig.key !== 'year') {
                    let yA = a.year === '-' ? -9999 : a.year;
                    let yB = b.year === '-' ? -9999 : b.year;
                    if (yA !== yB) return yB - yA; // Descending
                }
                
                if (sortConfig.key !== 'period') {
                    let pA = monthWeight[normalizeMonth(a.period)] || 0;
                    let pB = monthWeight[normalizeMonth(b.period)] || 0;
                    return pB - pA; // Descending
                }

                return 0;
            });

            renderTable();
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            const noResults = document.getElementById('noResults');
            tbody.innerHTML = '';
            
            const t = translations[currentLang];
            
            if (filteredData.length === 0) {
                document.getElementById('dataTable').style.display = 'none';
                noResults.style.display = 'block';
                document.getElementById('visibleCount').textContent = '0';
                return;
            }
            
            document.getElementById('dataTable').style.display = 'table';
            noResults.style.display = 'none';
            
            filteredData.forEach((item, index) => {
                const row = document.createElement('tr');
                const langBadge = item.lang ? `<span class="language-badge lang-${item.lang.toLowerCase()}">${item.lang}</span>` : '';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.year}</td>
                    <td>${item.period}</td>
                    <td><span class="category-cell category-${item.category.toLowerCase()}">${item.category}</span></td>
                    <td class="link-cell"><a href="${item.link}" target="_blank">${t.openFile}</a></td>
                    <td>${item.title}${langBadge}</td>
                    <td class="note-cell">${item.note || '-'}</td>
                `;
                
                tbody.appendChild(row);
            });
            
            document.getElementById('visibleCount').textContent = filteredData.length;
        }
        
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            // 1. Filter
            filteredData = data.filter(item => {
                const matchesSearch = 
                    item.year.toString().includes(searchTerm) ||
                    item.period.toLowerCase().includes(searchTerm) ||
                    item.category.toLowerCase().includes(searchTerm) ||
                    item.title.toLowerCase().includes(searchTerm) ||
                    (item.note && item.note.toLowerCase().includes(searchTerm));
                
                const matchesCategory = currentFilter === 'all' || item.category.toLowerCase() === currentFilter;
                const matchesYear = currentYearFilter === 'all' || item.year.toString() === currentYearFilter;
                
                const normalizedItemMonth = normalizeMonth(item.period);
                const normalizedFilterMonth = normalizeMonth(currentMonthFilter);
                const matchesMonth = currentMonthFilter === 'all' || normalizedItemMonth === normalizedFilterMonth;
                
                const itemLang = item.lang ? item.lang.toLowerCase() : 'id'; 
                const matchesLang = itemLang === currentLang;

                return matchesSearch && matchesCategory && matchesYear && matchesMonth && matchesLang;
            });
            
            // 2. Sort (Apply existing sort config to filtered results)
            // We temporarily reset key to re-trigger the sort logic without flipping direction
            const currentKey = sortConfig.key;
            const currentDir = sortConfig.direction;
            
            // Trick: call sortData but manually restore direction
            // Actually, simply re-running the sort logic is enough
            sortData(currentKey);
            // Restore direction if sortData flipped it (sortData flips if key matches)
            // Wait, sortData flips direction. So we need to set direction back or modify sortData.
            // Let's modify sortData slightly: if we pass a specific direction, use it.
            // Simplified approach: just re-sort array manually here using the logic inside sortData
            // Or better: Fix sortData to not flip if we don't want it to.
            // Current fix: Just re-assign the direction after calling sortData.
            
            if (sortConfig.direction !== currentDir) {
                 sortConfig.direction = currentDir;
                 // Re-sort with correct direction
                 // This is getting complex. Let's simplify:
                 // Separate "toggle sort" from "apply sort".
            }
        }
        
        // Revised Sort Function to separate Event from Logic
        // ... (Actually, for simplicity, I will stick to the click handler logic above 
        // and just let applyFilters rely on the fact that 'filteredData' is just an array.
        // We will call the sort logic directly.)

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', applyFilters);
        
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentFilter = this.dataset.filter;
                applyFilters();
            });
        });
        
        document.getElementById('yearFilter').addEventListener('change', function() {
            currentYearFilter = this.value;
            applyFilters();
        });
        
        document.getElementById('monthFilter').addEventListener('change', function() {
            currentMonthFilter = this.value;
            applyFilters();
        });
        
        document.getElementById('resetFilters').addEventListener('click', function() {
            currentFilter = 'all';
            currentYearFilter = 'all';
            currentMonthFilter = 'all';
            
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            document.querySelector('.filter-btn[data-filter="all"]').classList.add('active');
            document.getElementById('yearFilter').value = 'all';
            document.getElementById('monthFilter').value = 'all';
            document.getElementById('searchInput').value = '';
            
            applyFilters();
        });

        // Add Click Listeners to Headers
        document.querySelectorAll('th[data-sort]').forEach(th => {
            th.addEventListener('click', () => {
                sortData(th.dataset.sort);
            });
        });
        
        // Initialize
        document.getElementById('totalCount').textContent = data.length;
        populateYearFilter();
        
        // Set Initial Sort UI (Year Descending)
        const yearTh = document.querySelector('th[data-sort="year"]');
        if(yearTh) yearTh.classList.add('sort-desc');
        
        // Initial Render
        applyFilters(); 
    </script>
</body>
</html>
